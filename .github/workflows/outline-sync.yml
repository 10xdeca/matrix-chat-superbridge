name: Sync Docs to Outline
on:
  workflow_dispatch:
  push:
    branches: [main]
    paths: ['**/*.md']
  pull_request:
    paths: ['**/*.md']

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - uses: 10xdeca/outline-sync-action@main
        with:
          outline_api_key: ${{ secrets.OUTLINE_API_KEY }}
          collection_id: ${{ secrets.OUTLINE_COLLECTION_ID }}
          outline_base_url: ${{ secrets.OUTLINE_BASE_URL }}
          sync_mode: ${{ github.event_name == 'pull_request' && 'changed' || 'full' }}
          exclude_pattern: 'CLAUDE.md,matrix-docker-ansible-deploy/**/*.md'
